
using namespace std;


// defalt ã¯ 9e-6

void learning_rate(){ 
  double returning3[50] = {3.8006234169006348, 3.6424477100372314, 3.8571619987487793, 4.207303047180176, 4.679628849029541, 5.109182357788086, 5.3312273025512695, 5.60181999206543, 2.497852325439453, 2.374774694442749, 2.374459981918335, 2.3676342964172363, 2.344287157058716, 2.331014633178711, 2.316375255584717, 2.3220632076263428, 2.292168140411377, 2.26031231880188, 2.2995898723602295, 2.2591519355773926, 2.2716269493103027, 2.273881196975708, 2.2662038803100586, 2.2626888751983643, 2.224613666534424, 2.22839617729187, 2.2046313285827637, 2.2242209911346436, 2.231212615966797, 2.2551159858703613, 2.197127103805542, 2.228247880935669, 2.21693754196167, 2.2319886684417725, 2.1820590496063232, 2.193791627883911, 2.1785974502563477, 2.1736090183258057, 2.1665871143341064, 2.1662561893463135, 2.185634136199951, 2.162515163421631, 2.1726577281951904, 2.1511149406433105, 2.1452693939208984, 2.167165994644165, 2.133772373199463, 2.1498427391052246, 2.135873556137085, 2.157715320587158};
  double returning4[50] = {3.4548983573913574, 3.394765853881836, 3.6248679161071777, 3.958784580230713, 4.332741737365723, 4.687068939208984, 5.056465148925781, 5.320186614990234, 2.5107297897338867, 2.208482503890991, 2.1227431297302246, 2.1051218509674072, 2.109790325164795, 2.0810422897338867, 2.0924124717712402, 2.104797840118408, 2.0577495098114014, 2.069084882736206, 2.028956890106201, 2.0415496826171875, 2.0244193077087402, 2.045563220977783, 2.023719072341919, 2.0134358406066895, 2.001085042953491, 1.9894592761993408, 2.0055713653564453, 1.979004979133606, 1.977959394454956, 1.9677495956420898, 1.9566656351089478, 1.9451497793197632, 1.9599920511245728, 1.9549139738082886, 1.9465242624282837, 1.924999475479126, 1.9252493381500244, 1.928422451019287, 1.9213244915008545, 1.9194576740264893, 1.902466058731079, 1.913806438446045, 1.9002915620803833, 1.8989492654800415, 1.8894038200378418, 1.8691178560256958, 1.875684142112732, 1.8469626903533936, 1.8605403900146484, 1.839210867881775};
  double returning5[50] = {3.3099231719970703, 3.312429904937744, 3.5421433448791504, 3.8623576164245605, 4.180744647979736, 4.468781471252441, 4.7387542724609375, 4.9926958084106445, 2.516710042953491, 2.342529058456421, 2.1439993381500244, 2.1316959857940674, 2.1174652576446533, 2.098949909210205, 2.1026790142059326, 2.0793020725250244, 2.0580270290374756, 2.065371513366699, 2.0202250480651855, 2.0314743518829346, 2.013171911239624, 2.0043935775756836, 2.0212857723236084, 1.9770739078521729, 1.9837214946746826, 1.961472749710083, 1.9709796905517578, 1.9497346878051758, 1.9483168125152588, 1.9371148347854614, 1.9338716268539429, 1.9248974323272705, 1.903326153755188, 1.9091007709503174, 1.9102119207382202, 1.8726075887680054, 1.8844894170761108, 1.8732366561889648, 1.8780766725540161, 1.8632919788360596, 1.8812166452407837, 1.869850516319275, 1.8526830673217773, 1.8591461181640625, 1.8397884368896484, 1.843465805053711, 1.819946050643921, 1.838031530380249, 1.8135267496109009, 1.7918754816055298};
  double tauD5_lr2e_5[50] = {3.3085713386535645, 3.2289977073669434, 3.4018187522888184, 3.551161766052246, 3.7608909606933594, 4.006103515625, 4.327524185180664, 4.654053688049316, 2.1738064289093018, 2.1302897930145264, 2.1174535751342773, 2.1073217391967773, 2.1050562858581543, 2.0800747871398926, 2.0711870193481445, 2.055189847946167, 2.0424656867980957, 2.0382332801818848, 2.029289484024048, 1.9894274473190308, 1.9870151281356812, 1.9446771144866943, 1.9305665493011475, 1.938077688217163, 1.9051826000213623, 1.9120104312896729, 1.8691891431808472, 1.8765095472335815, 1.8704496622085571, 1.8640859127044678, 1.8545081615447998, 1.8544126749038696, 1.8380076885223389, 1.8368947505950928, 1.8407975435256958, 1.8227124214172363, 1.822160243988037, 1.8125379085540771, 1.8232576847076416, 1.8003357648849487, 1.7912955284118652, 1.788845181465149, 1.7856184244155884, 1.7966078519821167, 1.795357346534729, 1.7734652757644653, 1.7632105350494385, 1.7703816890716553, 1.7646740674972534, 1.7496743202209473};
  double tauD5_lr5e_5[50] = {3.255052328109741, 3.4143972396850586, 3.5303258895874023, 3.669780969619751, 3.8393349647521973, 3.9939022064208984, 4.189491271972656, 4.416443347930908, 2.0531692504882812, 2.0368285179138184, 1.9936351776123047, 1.967560052871704, 1.9408468008041382, 1.9041889905929565, 1.9000389575958252, 1.8437634706497192, 1.840084195137024, 1.8159935474395752, 1.8077008724212646, 1.8032422065734863, 1.761430263519287, 1.7483054399490356, 1.6921131610870361, 1.7111878395080566, 1.6887753009796143, 1.6952520608901978, 1.6969316005706787, 1.706167221069336, 1.6793177127838135, 1.6637243032455444, 1.657518744468689, 1.679374098777771, 1.6409564018249512, 1.6846115589141846, 1.5981858968734741, 1.6130203008651733, 1.621119737625122, 1.6091477870941162, 1.5843932628631592, 1.5889427661895752, 1.5791313648223877, 1.5877870321273804, 1.5629078149795532, 1.5757277011871338, 1.547433853149414, 1.5485578775405884, 1.535345435142517, 1.5414363145828247, 1.5630478858947754, 1.5261764526367188};
  double tauD5_lr1e_4[50] = {3.4531781673431396, 3.36073637008667, 3.5828046798706055, 3.715916633605957, 3.9654834270477295, 4.191806793212891, 4.38668966293335, 4.618752479553223, 1.8785215616226196, 1.8158371448516846, 1.7963030338287354, 1.734603762626648, 1.753147840499878, 1.706057071685791, 1.678852915763855, 1.6536306142807007, 1.6426070928573608, 1.6266956329345703, 1.6471558809280396, 1.6374446153640747, 1.6311503648757935, 1.597476601600647, 1.5989691019058228, 1.5772074460983276, 1.5735576152801514, 1.5559993982315063, 1.5735629796981812, 1.5680594444274902, 1.5651897192001343, 1.547234058380127, 1.5305871963500977, 1.5204436779022217, 1.5190362930297852, 1.5354492664337158, 1.508984088897705, 1.5195510387420654, 1.4887439012527466, 1.5207172632217407, 1.5084434747695923, 1.4901363849639893, 1.4902974367141724, 1.488419771194458, 1.492429256439209, 1.4579689502716064, 1.5045896768569946, 1.4573925733566284, 1.4663876295089722, 1.4329559803009033, 1.425419807434082, 1.4285494089126587};
  double tauD5_lr5e_4[50] = {3.5700762271881104, 3.9641337394714355, 4.254101753234863, 4.313976764678955, 4.4240875244140625, 4.7670440673828125, 4.803307056427002, 4.840275287628174, 1.807414174079895, 1.6800286769866943, 1.81047785282135, 1.6899020671844482, 1.6597627401351929, 1.6681567430496216, 1.6391645669937134, 1.681264877319336, 1.7099874019622803, 1.6927125453948975, 1.5862358808517456, 1.5495176315307617, 1.6314756870269775, 1.5436599254608154, 1.598907470703125, 1.5610175132751465, 1.6074062585830688, 1.692383885383606, 1.5879133939743042, 1.5339773893356323, 1.567276120185852, 1.509927749633789, 1.5147653818130493, 1.5663646459579468, 1.4459842443466187, 1.5351876020431519, 1.4993035793304443, 1.4721416234970093, 1.5156502723693848, 1.5026870965957642, 1.5037312507629395, 1.571221947669983, 1.512079119682312, 1.467445731163025, 1.488255262374878, 1.593131422996521, 1.4915480613708496, 1.5000261068344116, 1.5828968286514282, 1.4742754697799683, 1.539111852645874, 1.5294983386993408};

  // TGraph *g3 = new TGraph();
  // TGraph *g4 = new TGraph();
  TGraph *g5 = new TGraph();
  TGraph *g5_lr2e_5 = new TGraph();
  TGraph *g5_lr5e_5 = new TGraph();
  TGraph *g5_lr1e_4 = new TGraph();
  TGraph *g5_lr5e_4 = new TGraph();
  g5->GetXaxis()->SetTitle("epoch"); 
  g5->GetYaxis()->SetTitle("loss"); 
  g5->SetMinimum(1); 
  g5->SetMaximum(6); 
  g5->SetLineColor(1); 
  g5_lr2e_5->SetLineColor(2); 
  g5_lr5e_5->SetLineColor(3); 
  g5_lr1e_4->SetLineColor(4); 
  g5_lr5e_4->SetLineColor(6); 

  TLegend *legend_lr = new TLegend( 0.6, 0.48, 0.9, 0.78);
  legend_lr->AddEntry( g5, "D=4 lr=9e-6 (default)", "l");
  legend_lr->AddEntry( g5_lr2e_5, "D=4 lr=2e-5", "l");
  legend_lr->AddEntry( g5_lr5e_5, "D=4 lr=5e-5", "l");
  legend_lr->AddEntry( g5_lr1e_4, "D=4 lr=1e-4", "l");
  legend_lr->AddEntry( g5_lr5e_4, "D=4 lr=5e-4", "l");


  for(int i=0;i<50;i++){
    // g3->SetPoint(i,i,returning3[i]);
    // g4->SetPoint(i,i,returning4[i]);
    g5->SetPoint(i,i,returning5[i]);
    g5_lr2e_5->SetPoint(i,i,tauD5_lr2e_5[i]);
    g5_lr5e_5->SetPoint(i,i,tauD5_lr5e_5[i]);
    g5_lr1e_4->SetPoint(i,i,tauD5_lr1e_4[i]);
    g5_lr5e_4->SetPoint(i,i,tauD5_lr5e_4[i]);
  }

  TCanvas *c_lr = new TCanvas(1);
  c_lr->cd();
  g5->GetXaxis()->SetTitle("epoch"); 
  g5->GetYaxis()->SetTitle("loss"); 
  g5->SetMinimum(1); 
  g5->SetMaximum(6); 
  g5->Draw();
  g5_lr2e_5->Draw("same");
  g5_lr5e_5->Draw("same");
  g5_lr1e_4->Draw("same");
  g5_lr5e_4->Draw("same");
  legend_lr->Draw();

}